# name: test/sql/queries/basic_select.test_slow
# description: Basic SELECT queries via Flight SQL
# group: [queries]

# Tests in this file require a running Flight SQL server
# Run: ./scripts/test-servers.sh start before executing

require duckhog

require-env FLIGHT_HOST

require-env FLIGHT_PORT

require-env DUCKHOG_USER

require-env DUCKHOG_PASSWORD

# Connect to the Flight SQL server
statement ok
ATTACH 'hog:memory?user=${DUCKHOG_USER}&password=${DUCKHOG_PASSWORD}&flight_server=grpc+tls://${FLIGHT_HOST}:${FLIGHT_PORT}' AS remote;

# Test 1: Basic SELECT 1
query I
SELECT 1;
----
1

# Test 2: Query compatibility table exposed via Flight catalog
query I
SELECT CASE WHEN COUNT(*) > 0 THEN 1 ELSE 0 END FROM remote.main.pg_type;
----
1

# Test 3: Verify remote main schema is visible in information_schema
query I
SELECT CASE WHEN COUNT(*) > 0 THEN 1 ELSE 0 END
FROM information_schema.tables
WHERE table_catalog = 'remote' AND table_schema = 'main';
----
1
