# name: test/sql/integration/tables.test_slow
# description: Schema and table listing operations via Flight SQL
# group: [integration]

# Tests in this file require a running Flight SQL server
# Run: ./scripts/test-servers.sh start before executing

require duckhog

require-env FLIGHT_HOST

require-env FLIGHT_PORT

require-env DUCKHOG_USER

require-env DUCKHOG_PASSWORD

statement ok
ATTACH 'hog:memory?user=${DUCKHOG_USER}&password=${DUCKHOG_PASSWORD}&flight_server=grpc+tls://${FLIGHT_HOST}:${FLIGHT_PORT}&tls_skip_verify=true' AS remote;

# Test 4: Schema listing
query I
SELECT schema_name FROM information_schema.schemata WHERE catalog_name = 'remote';
----
main

# Test 5: Table listing - verify expected compatibility tables exist
query I rowsort
SELECT table_name FROM information_schema.tables
WHERE table_catalog = 'remote' AND table_schema = 'main'
  AND table_name IN ('pg_type', 'pg_namespace', 'pg_database', 'pg_roles', 'pg_class_full');
----
pg_class_full
pg_database
pg_namespace
pg_roles
pg_type
